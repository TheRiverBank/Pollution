---
title: "Energy"
author: "Sondre Løvås"
date: "09 12 2020"
---


<!-- DATA SOURCES
All data sources are listed here. If data is not gathered directly from the source, it will be specified by where data is downloaded/scraped from, and the original source.
Sources are also added under each plot with a hyperlink to the original source.

Emission by sector: https://www.climatewatchdata.org/data-explorer/historical-emissions  
Primary energy: downloaded from https://ourworldindata.org/energy, data provided by https://www.bp.com/en/global/corporate/energy-economics/statistical-review-of-world-energy.html 
Primary energy by source: downloaded from https://ourworldindata.org/grapher/primary-energy-consumption-by-source?time=1965..latest, data provided by https://www.bp.com/en/global/corporate/energy-economics/statistical-review-of-world-energy.html
Land temperature anomaly: https://www.ncdc.noaa.gov/cag/global/time-series/globe/land/ytd/12/1880-2019
sea surface temperature: https://www.epa.gov/climate-indicators/climate-change-indicators-sea-surface-temperature  
global co2 emission: https://www.climatewatchdata.org/data-explorer/historical-emissions  
ambient air pollution deaths: https://apps.who.int/gho/data/view.main.BODAMBIENTAIRDTHS  
natural disasters by type: downloaded from https://ourworldindata.org/natural-disasters, data provided by http://www.emdat.be/  
Sea level rise: https://www.star.nesdis.noaa.gov/socd/lsa/SeaLevelRise/LSA_SLR_timeseries.php  
ice amount: https://climate.nasa.gov/vital-signs/arctic-sea-ice/  
renewable energy investment: downloaded from https://ourworldindata.org/energy#investment-in-renewable-technologies, data provided by http://resourceirena.irena.org/gateway/dashboard/  
Co2 mitigation 1.5 and 2 degrees Celcius: https://folk.universitetetioslo.no/roberan/t/global_mitigation_curves.shtml  
Death rates from energy source, scraped: https://cambridgehouse.com/news/7971/energy-metals-the-worlds-safest-source-of-energy-will-surprise-you  
Electricity prices: https://ec.europa.eu/eurostat/data/database, filter: Enviroment and energy -> Energy -> Energy statistics -> Energy statistics - natural gas and electricity prices.
Electricity generated by source, France, scraped: https://www.globalpetrolprices.com/energy_mix.php?countryId=194, data provided by U.S. Energy Information Administration
Electricity generated by source, Germany, scraped: https://www.globalpetrolprices.com/energy_mix.php?countryId=195, data provided by U.S. Energy Information Administration
-->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(lubridate)
library(zoo)
library(scales)
library(reshape2)
library(ggplot2)
library(gridExtra)
library(rvest)
library(RColorBrewer)
library(maps)
```

```{r data, include=FALSE}
# The csv files used for this project, which is located in the data folder.
emision_by_sector <- read.csv("data/ghg-emissions-by-sector.csv", stringsAsFactors = FALSE)
global_primary_energy <- read.csv("data/global-primary-energy.csv", stringsAsFactors = FALSE)
primary_energy_by_source <- read.csv("data/primary-energy-consumption-by-source.csv", stringsAsFactors = FALSE)
land_temp_anomaly <- read.csv("data/land-temperature-anomaly.csv", stringsAsFactors = FALSE, skip = 4)
sea_surface_temp <- read.csv("data/sea-surface-temp.csv", stringsAsFactors = FALSE, skip = 6)
global_co_emission <- read.csv("data/annual-co-emissions-by-region.csv")
ambient_air_pollution_deaths <- read.csv("data/ambient-air-pollution-deaths.csv", stringsAsFactors = FALSE, skip = 2)
natural_disasters_by_type <- read.csv("data/natural-disasters-by-type.csv", stringsAsFactors = FALSE)
sea_level_rise <- read.csv("data/sea-level-rise.csv", stringsAsFactors = FALSE, skip = 5)
ice_amount <-read.csv("data/ice-amount.csv", stringsAsFactors = FALSE)
renewable_energy_investment <- read.csv("data/renewable-energy-investment.csv", stringsAsFactors = FALSE)
mitigation_curves_2.0C <- read.csv("data/mitigation_curves_2.0C.csv", stringsAsFactors = FALSE)
mitigation_curves_1.5C <- read.csv("data/mitigation_curves_1.5C.csv", stringsAsFactors = FALSE)
electricity_price_france <- read.csv("data/electricity-price-france.csv", stringsAsFactors = FALSE)
electricity_price_germany <- read.csv("data/electricity-price-germany.csv", stringsAsFactors = FALSE)
renewable_energy_consumption <- read.csv("data/renewable_energy_consumption.csv", stringsAsFactors = FALSE, sep = ";")
```



```{r emissionBySEctor, include=FALSE}
emission_summarized <- emision_by_sector %>%
  group_by(Year) %>% # Get global emissions by summing emissions from each year.
  summarise_at(vars(Agriculture..GHG.Emissions..CAIT.:Transport..GHG.Emissions..CAIT.), sum, na.rm=TRUE) 

# Melt the data frame to get all sectors in one variable. 
df_emission_by_sector <- melt(emission_summarized, id.vars = c("Year")) %>%
  mutate(variable =
           recode(variable, # Rename emission sectors to make them more manageable.
                  "Agriculture..GHG.Emissions..CAIT."="Agriculture",
                  "Bunker.Fuels..GHG.Emissions..CAIT."="Shipping",
                  "Industry..GHG.Emissions..CAIT."="Industry",
                  "Land.Use.Change.and.Forestry..GHG.Emissions..CAIT."="Land-Use Change and Forestry",
                  "Waste..GHG.Emissions..CAIT."="Waste",
                  "Buildings..GHG.Emissions..CAIT."="Buildings",
                  "Electricity...Heat..GHG.Emissions..CAIT."="Electricity and Heat",
                  "Fugitive.from.energy.production..GHG.Emissions..CAIT."="Fugitive",
                  "Manufacturing.Construction.energy..GHG.Emissions..CAIT."="Manufacturing and Construction",
                  "Other.Fuel.Combustion..GHG.Emissions..CAIT."="Other fuel combustion",
                  "Transport..GHG.Emissions..CAIT."="Transport"))

# Subset emissions for only the year 2016.
total_emission_2016 <- df_emission_by_sector %>%
  filter(Year==2016) %>%
  summarize(Totlal_Emission=sum(value, na.rm = TRUE))

# Subset only emissions from electricity and heat in 2016.
total_electricity_2016 <- df_emission_by_sector %>%
  filter(Year==2016 & variable=="Electricity and Heat") %>%
  summarize(Total_Electricity=sum(value, na.rm = TRUE))
```

```{r globalEnergySources, include=FALSE}
# Melt the data frame to get all energy sources in one variable.
df_global_primary_energy <- melt(global_primary_energy, id.vars = "Year") %>% # Melt data frame such that all sources are in one column.
  filter(Year >= 1965) %>%
  mutate(variable =
           recode(variable, # Rename energy sources to make them more manageable.
                  "Coal..TWh..direct.energy."="Coal",
                  "Oil..TWh..direct.energy."="Oil",
                  "Gas..TWh..direct.energy." = "Gas",
                  "Hydropower..TWh..direct.energy."="Hydropower",
                  "Nuclear..TWh..direct.energy."="Nuclear",
                  "Solar..TWh..direct.energy."="Solar",
                  "Other.renewables..TWh..direct.energy."="Other renewables",
                  "Traditional.biomass..TWh..direct.energy."="Biomass",
                  "Wind..TWh..direct.energy."="Wind",
                  "Biofuels..TWh..direct.energy." = "Biofuels")
         )

# Subset only nonrenewable sources.
df_global_primary_nonrenew <- df_global_primary_energy %>%
  filter(variable == c("Coal", "Oil", "Gas"))

# Subset only renewable sources.
df_global_primary_renew <- df_global_primary_energy %>%
  filter(variable == c("Hydropower", "Solar", "nuclear"," Other renewables", "Wind", "Nuclear"))
```

```{r renewableEnergyInvestment, include=FALSE}
# Investment in renewable energy.
df_renewable_investment <- renewable_energy_investment %>%
  group_by(Entity) %>%
  rename("Investment"="Investment.in.Renewables.by.Region..IRENA..2016..")
```

```{r globalTempAnomaly, include=FALSE}
# Temperature anomalies since the industrial revolution.
df_land_temp_anomaly <- land_temp_anomaly %>%
  mutate(Value = replace(Value, Value == -999, NA)) # NA values are represented as -999 in original dataset. 
```

```{r seaLeveLTemp, include=FALSE}
# Anomalies in surface temperature since the industrial revolution.
df_sea_surface_temp <- sea_surface_temp %>%
  select(Year, Annual.anomaly) # Subset year and annual anomaly.
```

```{r gloablCoEmission, include=FALSE}
# Data set contains co2 emissions form each country and a 'world' variable for global co2 emission.
df_global_co_emission <- global_co_emission %>%
  filter(Entity=="World" & Year >= 1880) %>% # Get emission for the whole world from 1880 to latest year.
  group_by(Year) %>%
  summarize(Sum_Year=sum(Annual.CO2.emissions)) # Sum of co2 emissions each year.
```

```{r ambientAirPollutionDeaths, include=FALSE}
# Variables are represented in the form: median [range].
pollution_deaths_2016 <- ambient_air_pollution_deaths %>%
  filter(Cause=="Total") %>% # Total is all causes of death summarized. 
  mutate(Both.sexes=as.numeric(gsub("([0-9]+) .*", "\\1", Both.sexes))) %>% # Only want median value.
  summarise(Sum_Deaths=sum(Both.sexes, na.rm = TRUE)) # Get total deaths.
```

```{r naturalDisaters, include=FALSE}
df_natural_disasters <- natural_disasters_by_type %>%
  filter(Entity==c("Wildfire", "Drought", "Extreme temperature", "Flood")) %>% # Subset the disasters to be inspected.
  rename("Num_Disasters"=Number.of.disasters..EMDAT..2020..) # Rename column to make it more manageable.
```

```{r globalSeaLevel, include=FALSE}
# Melt data frame to get data from the altimeters in one variable.
df_sea_level_rise_global <- melt(sea_level_rise, id.vars = "year") %>%
  drop_na() %>% # Remove any empty values.
  mutate(Ocean="Global")
```

```{r regionalSeaLevelScrape, eval=FALSE, include=FALSE}
# Scrape sea level data. 
# This chunk will download sea data from https://www.star.nesdis.noaa.gov/socd/lsa/SeaLevelRise/LSA_SLR_timeseries.php,
# The data up until December 2020 is already found in the 'regional sea level' folder.
sea_level_URL <- "https://www.star.nesdis.noaa.gov/socd/lsa/SeaLevelRise/LSA_SLR_timeseries.php"
sea_URL_short <- "https://www.star.nesdis.noaa.gov/socd/lsa/SeaLevelRise/"
webpage <- read_html(sea_level_URL)


# This function will scrape and download the csv files to the oceans passed. 
download_ocean_data <- function(oceans) {
  for (i in 4:27) {
    ocean_name_node <- sprintf("#list2 tr:nth-child(%s) th", i)
    ocean_name <- webpage %>% html_nodes(ocean_name_node) %>% html_text()
    # Check if the current ocean is desired.
    if (ocean_name %in% oceans) {
      # Website's csv files are downloadable through the resulting URL when concatenating the short URL with the csv file name.
      ocean_name_nospace <- gsub(" ", "-", ocean_name) # Remove spaces from ocean name.
      file_node<- sprintf("#list2 tr:nth-child(%s) th+ td a:nth-child(1)", i) # Get the node in which the file name is located.
      file_name <- webpage %>% html_nodes(file_node) %>% html_attr("href") # Extract the file name from the file node.
      file_URL <- paste(sea_URL_short, file_name, sep="") # Concatenate short URL and csv file name to get the csv file that will be downloaded.
      dest <- paste("data/regional-sea-level/", ocean_name_nospace, ".csv", sep="") # Specify the location where the file will be stored.
      download.file(url=file_URL, destfile = dest) # Download the file in the specified location.
    }
  }
}
```

```{r wrangleRegionalSeaLevelData, include=FALSE}
# A function that will 
get_ocean_data <- function(oceans) {
  df_sea_level_rise_regional <- NULL
  for (ocean in oceans) {
    file_path <- paste("data/regional-sea-level/", ocean, ".csv", sep="")
    file <- read.csv(file_path, stringsAsFactors = FALSE, skip = 5)
    average_sea_level_change <- melt(file, id.vars = "year")
    if (is.null(df_sea_level_rise_regional)) {
      df_sea_level_rise_regional <- data.frame(Ocean=ocean, Average_change=average_sea_level_change)
    } else {
      df_temp <- data.frame(Ocean=ocean, Average_change=average_sea_level_change)
      df_sea_level_rise_regional <-  rbind(df_sea_level_rise_regional, df_temp)
    }
  }
  df_sea_level_rise_regional <- df_sea_level_rise_regional %>%
    rename("year"=Average_change.year, "variable"=Average_change.variable, "value"=Average_change.value)
  
  return(df_sea_level_rise_regional)
}
```

```{r reguonalSeaDataClean, include=FALSE}
oceans <- c("Pacific-Ocean", "Atlantic-Ocean", "Indian-Ocean")
# scrape, download, and assemble the desired oceans into one data frame.
# The commented code line under must be uncommented when other, or newer ocean data is wanted.

#
#download_ocean_data(oceans)
#

df_sea_level_by_ocean <- get_ocean_data(oceans)
```

```{r arcticSeaIce, include=FALSE}
# Creates a data frame of ice changes on the Arctic.
df_arctic_sea_ice <- ice_amount %>%
  select(c(year, extent)) # Subset year and changes in area.
```

```{r renewableEnergyConsumption, include=FALSE}
# Consumption of renewable energy by source.
df_renewable_energy_consumption <- primary_energy_by_source %>%
  select(Entity, Year, Geo.Biomass.Other...TWh, Hydro.Generation...TWh, Solar.Generation...TWh, Wind.Generation..TWh) # Subset renewables.

# Melt the renewable data frame to get each energy source in one variable.
df_renewable_energy_consumption_sum <- melt(df_renewable_energy_consumption, id.vars=c("Entity", "Year")) %>%
  group_by(Year, Entity) %>%
  summarize(Sum_Renew = sum(value)) # Get the sum of renewable energy consumption each year.

df_renewable_energy_consumption_2019 <- df_renewable_energy_consumption_sum %>%
  filter(Year==2019) %>% # Subset consumption of renewables for only 2019
  rename("region" = Entity) # Rename entity to a more clear name.
```

```{r include=FALSE}
# Consumption of renewables.
df_renewable_consumption <- renewable_energy_consumption[1:111, ] %>%
  select(Exajoules, X2019) %>%
  drop_na() %>%
  rename("Region" = Exajoules, "2019" = X2019)
df_renewable_consumption
```

```{r mitigationCurves, include=FALSE}
# Mitigation curves data set examines how drastic co2 reduction must be in order to stay under 2 and 1.5 deg Celsius by year 2100.
# The historical variable is the changes in co2 emission from 1750 up until 2019.
# It is desired that in a plot, the color of the historical values differ from the other variables. 
# To this purpose, subsets are created for both 2 and 1.5 degrees that only contain the historical values, and subsets without the historical values.
# This is something that is recognized to need another more functional solution.

df_mitigation_curves_2.0C_hist <- melt(mitigation_curves_2.0C, id.vars = "Year") %>%
  filter(Year >= 1980, variable == "Historical")

df_mitigation_curves_2.0C_exclud <- melt(mitigation_curves_2.0C, id.vars = "Year") %>%
  filter(Year >= 1980, variable != "Historical")

df_mitigation_curves_1.5C_hist <- melt(mitigation_curves_1.5C, id.vars = "Year") %>%
  filter(Year >= 1980, variable == "Historical")

df_mitigation_curves_1.5C_exclud <- melt(mitigation_curves_1.5C, id.vars = "Year") %>%
  filter(Year >= 1980, variable != "Historical")
```

```{r deathsBySorce, include=FALSE}
# Scrape table from website.
# Table expressed as:
# Energy Source | Deaths per 1,000 TWh  | % of Global Primary Energy Supply (2015)

URL <- "https://cambridgehouse.com/news/7971/energy-metals-the-worlds-safest-source-of-energy-will-surprise-you"
webpage <- read_html(URL)
result <- NULL
i <- 0
for (i in 1:7) {
  source_node <- sprintf("tr:nth-child(%s) td:nth-child(1)", i) # Node in which energy source name is located.
  source_name <- webpage %>% html_nodes(source_node) %>% html_text() # Extract energy source name from source node.
  death_node <- sprintf("tr:nth-child(%s) td:nth-child(2)", i) # Node in which the number of deaths is located.
  death_num <- webpage %>% html_nodes(death_node) %>% html_text() # Number of deaths from the death node.
  result <- rbind(result, c(source_name, death_num)) # Bind all the results into one vector.
}

df_deaths_by_source <- as.data.frame(result, stringsAsFactors = FALSE) %>% # Turn vector into data frame.
  rename("Source" = V1, "Deaths_Per_1000_TWh" = V2) %>% # Rename columns to make them explanatory.
  mutate(Deaths_Per_1000_TWh = as.numeric(gsub(",", "", Deaths_Per_1000_TWh))) # Replace comma with dot and convert number of deaths to numeric.
```

```{r include=FALSE}
# Function to clean electricity prices from the GlobalPetrolPrices website.
clean_price_data <- function(data) {
  df_electricity_price_france <- data %>%
  select(TIME, Value) %>% # Want year and quarter expressed as TIME, and value.
  mutate(TIME = gsub("S.*", "", TIME), Value = as.numeric(Value)) %>% # Remove quarter.
  group_by(TIME) %>%
  summarise(Value = mean(Value, na.rm=TRUE)) # With quarter removed, calculate mean each year.
}

df_electricity_price_france <- clean_price_data(electricity_price_france) 
df_electricity_price_germany <- clean_price_data(electricity_price_germany)
```

```{r scrapeElectricityPrice, include=FALSE}
# Function that will scrape countries share of electricity sources from GlobalPetrolPrices website and return a data frame.
scrape_electricity <- function(URL) {
  webpage <- read_html(URL)
  result <- NULL
  i <- 0
  for (i in 2:7) {
    source_node <- sprintf("tr:nth-child(%s) td:nth-child(1)", i) # Node in which energy source name is located. Use sprintf to iterate over all wanted nodes.
    source_name <- webpage %>% html_nodes(source_node) %>% html_text() # Extract energy source name from source node.
    source_name <- gsub("[\r\n\t]", "", source_name) # Remove unwanted characters
    value_node <- sprintf("tr:nth-child(%s) td:nth-child(2)", i) # Node in which value to energy source is located. Use sprintf to iterate over all wanted nodes.
    value <- webpage %>% html_nodes(value_node) %>% html_text() # Extract value from value node.
    value <- gsub("[\r\n\t]", "", value) # Remove unwanted characters from value node.
    
    result <- rbind(result, c(source_name, value)) # Bind data into a vector.
  }
  
  df <- as.data.frame(result, stringsAsFactors = FALSE) %>% # Convert the vector into a data frame.
    rename("Energy_Source" = V1, "Perc_Of_Total" = V2) %>% # Rename columns to more explanatory ones.
    mutate(Perc_Of_Total=as.numeric(Perc_Of_Total)) # Convert the value to numeric
  
  return(df)
}
```

```{r electricityPrices, include=FALSE}
df_electricity_sources_france <- scrape_electricity("https://www.globalpetrolprices.com/energy_mix.php?countryId=194") # Share of electricity sources in France.
df_electricity_sources_germany <- scrape_electricity("https://www.globalpetrolprices.com/energy_mix.php?countryId=195") # Share of electricity sources in Germany.

# Combine the column with values from Germany with the France data table.
# Use cbind functionality to specify which country the values belong to, then rename them to make them more explanatory. 
df_electricity_sources_combined <- cbind(France = df_electricity_sources_france, Germany = df_electricity_sources_germany$Perc_Of_Total) %>%
  rename("Energy_Source" = France.Energy_Source, "France" = France.Perc_Of_Total)

# Melt the combined data frame to get the values in one variable.
df_electricity_sources_combined <- melt(df_electricity_sources_combined, id.vars="Energy_Source")
```

```{r plotAstetics, include=FALSE}
# The theme and text adjustment that will be usd for all graphs.
pltTheme <- theme_light() + theme(plot.title = element_text(hjust = 0.5))
```

# Introduction
In this project, air pollution from greenhouse gases are discussed.
The motivation for the project is looking at what energy sources that the people of the world uses, that contributes the most towards global warming.
Furthermore, it is looked into how nature is affected by global warming, and how decarbonization evolving.


# Emission causes and effects

This plot shows how many million tonnes of greenhouse gasses that were released from 1990-2016, measured in the equivalent amount of carbon dioxide that would produce that same amount of energy.

```{r pltEmissionBySector, echo=FALSE, fig.width=10, fig.align="center"}
ggplot(df_emission_by_sector, aes(Year, value, col=variable)) + 
  labs(y="Million tonnes", title="Emission by sector in million tonnes carbon dioxide-equivalents", colour="Sector") +
  pltTheme +
  geom_line()
```
Source: [Climate Watch Data Explorer](https://www.climatewatchdata.org/data-explorer/historical-emissions?historical-emissions-data-sources=cait&historical-emissions-gases=all-ghg&historical-emissions-regions=All%20Selected&historical-emissions-sectors=total-including-lucf&page=1)


Electricity an heat seems to be a big contributor to greenhouse gases. Of the `r format(round(total_emission_2016), big.mark=",",scientific=FALSE)` tonnes of greenhouse gases, electricity and heat makes out to be `r format(round((total_electricity_2016/total_emission_2016)*100))`% of the total emission.

Transport, buildings, industries, electricity and heat all need a source of energy. 
Let's look at the primary sources of energy the world consumes.

```{r pltPrimaryEnergySourcesGlobaly, echo=FALSE, fig.width=14, fig.align="center"}
ggplot(df_global_primary_energy, aes(Year, value, col=variable)) + 
  labs(y="TWh", title="Global primary energy sources.", colour="Source") +
  pltTheme +
  geom_line()
```
Source: [bp Statistical Review of World Energy](https://www.bp.com/en/global/corporate/energy-economics/statistical-review-of-world-energy.html)


As expected, coal, oil and gas are the worlds primary energy sources. The next visualization tries to emphasize in a higher degree.

```{r pltPrimaryEnergySourcesStack, echo=FALSE, fig.align="center"}
ggplot(df_global_primary_energy, aes(Year, value, fill=variable)) + 
  labs(y="TWh", title="Global primary energy sources.", colour="Source") +
  pltTheme +
  geom_area(position = "stack") 
```
Source: [bp Statistical Review of World Energy](https://www.bp.com/en/global/corporate/energy-economics/statistical-review-of-world-energy.html)


The use of nonrenewable energy, and the greenhouse gases it emits, correlates to rising temperatures across the world. 
Under is a visualization of rising temperatures in both land and sea surface, and the amount of carbon dioxide emitted from fossil fuels. 

```{r pltEmissionAndTemp, echo=FALSE, fig.width=14, fig.width=10, fig.height=10, fig.align="center"}
plt_emission <- ggplot(df_global_co_emission, aes(x=Year, y=Sum_Year)) +
  geom_line(color="red") +
  labs(y="Co2 emission in milion tonnes") +
  pltTheme

plt_temperature_land <- ggplot(df_land_temp_anomaly, aes(x=Year, y=Value)) +
  geom_line(color="blue") +
  labs(y="Temperature land") +
  pltTheme

plt_temperature_sea <- ggplot(df_sea_surface_temp, aes(x=Year, y=Annual.anomaly)) +
  geom_line(color="green") +
  labs(y="Temperature sea surface") +
  pltTheme

grid.arrange(plt_emission, plt_temperature_land, plt_temperature_sea, nrow=3) # Create a three row plot grid.
```
Source:  
Co2, [Climate Watch](https://www.climatewatchdata.org/data-explorer/historical-emissions?historical-emissions-data-sources=cait&historical-emissions-gases=all-ghg&historical-emissions-regions=All%20Selected&historical-emissions-sectors=total-including-lucf&page=1)     
Land temperature, [NOAA](https://www.ncdc.noaa.gov/cag/global/time-series/globe/land/ytd/12/1880-2019)  
Sea surface temperature, [EPA](https://www.epa.gov/climate-indicators/climate-change-indicators-sea-surface-temperature)  

There is a `r format(round(cor(df_global_co_emission$Sum_Year, df_land_temp_anomaly$Value[0:139]), 2), nsmall=2)` correlation between the rising land temperatures and carbon dioxide emissions. 

Furthermore, ambient air pollution which is pollution from motor vehicles, oil and coal power plants, oil refineries etc. has resulted in `r format(pollution_deaths_2016,big.mark=",",scientific=FALSE)` deaths across the globe in 2016$^{[1][2]}$. Research has also suggested that greenhouse gases has increased the  frequency of natural disasters like hurricanes, floods, storms, droughts and wildfires$^{[3]}$.

```{r pltNaturalDisasters, echo=FALSE, fig.width=10, fig.align="center"}
ggplot(df_natural_disasters, aes(x=Year, y=Num_Disasters, fill=Entity)) +
  labs(y="Value", title="Number of natural disasters.") +
  geom_col() +
  pltTheme +
  theme(legend.position = "none") +
  facet_wrap(~Entity, scales = "free_y")
```
Source: [EM-DAT](https://www.emdat.be/)

Floods could be linked to rising sea levels which again is caused by melting ice in the arctics.
This plot shows the rate at which ice is depleting from the arctic.

```{r pltArcticIce, echo=FALSE, fig.align="center"}
ggplot(df_arctic_sea_ice, aes(x=year, y=extent)) +
  labs(y="Million square km.") +
  pltTheme +
  geom_line()
```
Source: [NASA climate](https://climate.nasa.gov/vital-signs/arctic-sea-ice/)

Here is a plot of changing water levels globally, and  for some of the larger oceans in the world. The change is expressed in millimeters and the sea level is thought to be rising by an average of three millimeters a year. 

```{r pltSeaLevel, echo=FALSE, fig.width=14, fig.align="center", message=FALSE, warning=FALSE}
ggplot(data=df_sea_level_by_ocean, aes(x=year, y=value, color=variable)) +
  geom_line(data=df_sea_level_rise_global) +
  geom_line() +
  geom_smooth() +
  labs(y="Millimeters", title="Change is sea level.", colour="Altimeter") +
  scale_x_continuous(breaks = seq(1992, 2020, by=5)) +
  pltTheme +
  facet_wrap(~Ocean)
```
Source: [NOAA/NESDIS/STAR Laboratory for Satellite Altimetry](https://www.star.nesdis.noaa.gov/socd/lsa/SeaLevelRise/LSA_SLR_timeseries.php)





# Preventing increased pollution
The world is taking steps towards reducing our carbon footprint. The Paris agreement is an effort to reduce global greenhouse emissions and has set a goal that the global temperature will not exceed 2 degrees Celsius by the year 2100 or at best case 1.5 degrees Celsius.
This primarily means that the use of fossil fuels has to decline and be replaced by renewable sources. 

Dividing the renewable sources from the nonrenewable sources in the previous energy sources plot, it can bee seen that renewable energy has been on a heavy rise since around 2005. 

```{r pltNonVsRenew, echo=FALSE, fig.width=14, fig.align="center"}
plt_renew <- ggplot(df_global_primary_renew, aes(Year, value, col=variable)) + 
  labs(y="TWh", title="comsumption of renewable energy.", colour="Renewable sources") + 
  pltTheme +
  geom_line()

plt_nonrenew <- ggplot(df_global_primary_nonrenew, aes(Year, value, col=variable)) +
  labs(y="TWh", title="Consumption of nonrenewable energy.", color="Nonrenewable sources") +
  pltTheme +
  geom_line()

grid.arrange(plt_renew, plt_nonrenew, ncol=2) # Create a two column plot grid.
```
Source: [bp Statistical Review of World Energy](https://www.bp.com/en/global/corporate/energy-economics/statistical-review-of-world-energy.html)

Here, nuclear energy has been chosen to be added to the renewable sources. This is because research shows it is far safer than any nonrenewable sources and is close to being as safe as any of the other renewable sources on this graph.
As the next chart shows, deaths because of nuclear energy is surprisingly low.

```{r pltDeathsByEnergySource, echo=FALSE, fig.width=8, fig.align="center"}
ggplot(df_deaths_by_source, aes(x = Source, y = Deaths_Per_1000_TWh, fill = Source)) + 
  labs(y="Deaths", x="Energy source", title="Deaths per 1,000 TWh by energy source in 2015.")+
  pltTheme +
  theme(legend.position = 0) +
  geom_col()
```
Source: [Cambridge House](https://cambridgehouse.com/news/7971/energy-metals-the-worlds-safest-source-of-energy-will-surprise-you)

Additionally, the CO2 emissions from nuclear energy is very low, even lower than energy for wind and from photovoltaic sources$^{[5]}$. It even seems like the reliability of nuclear energy makes it cheaper, and in fact, it has one of the highest returns of investment$^{[6]}$. This can be shown by comparing the two neighboring countries France and Germany. Both has made efforts to reduce greenhouse gas emissions by switching to renewable sources, but their cahgen in electricity prices are very different. 

```{r pltElectricityPriceGrFr, echo=FALSE, fig.width=8, fig.align="center"}
ggplot() +
  geom_col(data=df_electricity_price_germany, aes(x=TIME, y=Value, fill="Germany")) +
  geom_col(data=df_electricity_price_france, aes(x=TIME, y=Value, fill="France")) +
  labs(x="Year", y="Price €", colour="Country", title="Electricity cost per KWh") +
  pltTheme
```
Source: 
France, [GlobalPertrolPrices](https://www.globalpetrolprices.com/energy_mix.php?countryId=194, data provided by U.S. Energy Information Administration)  
Germany, [GlobalPertrolPrices](https://www.globalpetrolprices.com/energy_mix.php?countryId=195, data provided by U.S. Energy Information Administration)  


The reason for this is thought to be the extended use of nuclear energy in France.

```{r pltElectricityShareGrFr, echo=FALSE, fig.width=8, fig.align="center"}
ggplot(df_electricity_sources_combined, aes(x="", y=value, fill=Energy_Source)) +
  geom_bar(stat="identity", width=1, color="white") +
  coord_polar("y", start=0) +
  theme_void() +
  labs(title="share of total electricity generation by source", fill="Energy source") +
  theme(plot.title = element_text(hjust = 0.5)) +
  facet_wrap(~variable)
```
Source: 
France, [GlobalPertrolPrices](https://www.globalpetrolprices.com/energy_mix.php?countryId=194)  
Germany, [GlobalPertrolPrices](https://www.globalpetrolprices.com/energy_mix.php?countryId=195)  


The rise in renewable energy sources is partly an effect of greater investment in renewable energy sources, due to the current climate policies. 

```{r pltRenewableInvestment, echo=FALSE, fig.width=14, fig.align="center"}
ggplot(df_renewable_investment, aes(x=Year, y=Investment, colour=Entity)) + 
  labs(y="Investment in billion USD.") +
  pltTheme +
  geom_line()
```
Source: [IRENA](http://resourceirena.irena.org/gateway/dashboard/)

Lets take a closer look at which countries produces the most renewable energy, excluding the image of nuclear as a renewable source.



```{r echo=FALSE, fig.width=14}
test <- df_renewable_energy_consumption_2019 %>% 
  filter(!region %in% c("Asia Pacific", "Europe", "North America", "World")) # Filter out non country regions.

# Plot the top five countries.
ggplot(top_n(test, 5), aes(x=region, y=Sum_Renew, fill=region)) +
  geom_col() +
  pltTheme
```



But, due to the size of the population of these countries, renewable energy capacity per capita is quite low. The countries that produce the most renewable energy are not at all the ones that deliver the most renewable energy per capita as the next plot shows. 



# Conclusions
Decreasing co2 emissions to stay clear of an 2.0 degree Celsius global temperature increase is no small feat, and for 1.5 degrees Celsius, nearly impossible.
Here it is shown how much co2 emission the world has to drop to stay clear of these temperature increases by what year year we start in.

```{r pltMitigationCurves, echo=FALSE, fig.width=14, fig.height=15, fig.align="center", message=FALSE, warning=FALSE}
ncols = 30 # 30 columns
colors <- colorRampPalette(brewer.pal(8, "BuPu"))(ncols) # Create color palette for the 30 columns

plt_2.0C <- ggplot(df_mitigation_curves_2.0C_exclud, aes(x=Year, y=value, color=variable)) +
  geom_line(data=df_mitigation_curves_2.0C_hist,color="black") +
  pltTheme +
  theme(legend.position = 0) +
  scale_color_manual(values=colors) +
  labs(y="Billion tonnes", title="CO2 reduction needed to stay under 2,0°C") +
  geom_line()

plt_1.5C <- ggplot(df_mitigation_curves_1.5C_exclud, aes(x=Year, y=value, color=variable)) +
  geom_line(data=df_mitigation_curves_2.0C_hist,color="black") +
  pltTheme +
  theme(legend.position = 0) +
  scale_color_manual(values=colors) +
  labs(y="Billion tonnes", title="CO2 reduction needed to stay under 1,5°C") +
  geom_line()

grid.arrange(plt_2.0C, plt_1.5C, nrow=2) # Create a two column plot grid.
```
Source: [CICERO, Robbie Andrew](https://folk.universitetetioslo.no/roberan/t/global_mitigation_curves.shtml)

Analysis has estimated that with no climate policies implemented, the global temperature would rise to 4.1°C in 2100$^{[4]}$.
Luckily the world is taking action and with current policies the temperature anomaly will hopefully stay under 3°C. To aid with this goal, more extensive use of nuclear energy is thought to be a good substitution to especially nonrenewable sources. Nuclear has low greenhouse gas emissions while it also preserves our nature from massive solar and wind farms.

## References  
Global temperature anomaly
https://www.ncdc.noaa.gov/cag/global/time-series/globe/land_ocean/ytd/12/1880-2019  
[1].https://www.who.int/airpollution/ambient/pollutants/en/ WHO Ambient air pollution  
[2].https://apps.who.int/gho/data/node.main.BODAMBIENTAIRDTHS?lang=en WHO Deaths caused by ambient air pollution  
[3].Anderson, Jason, and Camilla Bausch. "Climate Change and Natural Disasters: Scientific evidence of a possible relation between recent natural disasters and climate change." Policy Department Economic and Scientific Policy 2 (2006).     
[4].https://climateactiontracker.org/global/temperatures/  
[5].https://www.giss.nasa.gov/meetings/pollution2002/summaryd.html 
[6].https://www.world-nuclear.org/information-library/energy-and-the-environment/energy-return-on-investment.aspx table 2.      